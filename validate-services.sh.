#!/bin/bash

# List of services you want to build
SERVICES=("ui" "catalog" "cart" "orders" "checkout")

# Base src directory
BASE_DIR="./src"

# Flag to track errors
ERRORS=0

echo "Checking services and Dockerfiles..."

for SERVICE in "${SERVICES[@]}"; do
    SERVICE_DIR="$BASE_DIR/$SERVICE"
    DOCKERFILE="$SERVICE_DIR/Dockerfile"

    if [ ! -d "$SERVICE_DIR" ]; then
        echo "‚ùå Service folder missing: $SERVICE_DIR"
        ERRORS=$((ERRORS+1))
    else
        echo "‚úÖ Service folder exists: $SERVICE_DIR"
        
    fi

    if [ ! -f "$DOCKERFILE" ]; then
        echo "‚ùå Dockerfile missing in: $SERVICE_DIR"
        ERRORS=$((ERRORS+1))
    else
        echo "‚úÖ Dockerfile exists in: $SERVICE_DIR"
    fi
done

if [ $ERRORS -eq 0 ]; then
    echo "üéâ All services and Dockerfiles are present!"
else
    echo "‚ö†Ô∏è  Found $ERRORS issue(s). Fix them before pushing to CodeBuild."
    exit 1
fi

